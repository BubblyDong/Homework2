车票管理系统设计文档
1．引言    
1.1编写目的    
编写详细设计说明书是软件开发过程必不可少的部分，其目的是为了使开发人员在完成概要设计说明书的基础上完成概要设计规定的各个功能块的具体实现的设计工作。通过对所产生的功能模块进行过程描述，开发一个可以直接转化成程序语言的软件标识，这样可以使软件设计人员很好的了解软件的功能，并对软件的所有模块有一个更深的了解。本说明书在概要设计的基础上，对车站售票管理系统的各模块，程序，子系统分别进行了实现层面上的要求和说明，为进行后面的实现和测试做准备，检验本系统的各项性能指标，及时发现纰漏及时修补。
   
1.2定义    
时序图：亦称为序列图或循序图，是一种UML行为图。它通过描述对象之间发送 消息的时间顺序显示多个对象之间的动态协作。它可以表示用例的行为顺序，当执行一个用例行为时，时序图中的每条消息对应了一个类操作或状态机中引起转换的触发事件  SqlClien：包含有关专门操作SqlServer数据库的类,包含的是一些数据库操作 所需要用到的普通数据，如数据表，数据行等   包：多个类的集合   

2．总体设计
2.1需求概述    
火车站售票管理系统主要实现售票自动化，包括售票，订票、退票，查询，统计，为了保证系统正常运行，另外需要专门人员对系统的维护管理。   
（1）登录：登录可分为系统管理员登录和售票员登录，在登录模块的描述中，将系统管理员和售票员都看作这个系统的用户，他们根据自己的登录名和密码登录系统，才可进行以后的操作。若用户名和密码输入错误，不匹配，系统将会提示输入错误。若用户名和密码不正确，用户可已重新输入，但只允许输入三次。    
（2）查询：查询分为车次查询、站点查询、时刻表查询、票价查询、余票查询。车次查询提供了所有车次浏览、按车次查询、和站站查询，用户可以通过查询来了解列车所经车站以及发车时间等信息。时刻表查询可以查询每一车次在每一站的发车时间和到站时间。票价查询可以让用户按自己的需求来查询所有车次的车票价格；余票查询可以查询到所有车次的剩余车票的情况；    
（3）售票：根据旅客的需求如发车日期、发车时间、车厢类型、车票类型（学生票、军人票…）等选择用户所需要的车次，然后结算并打印车票给旅客。      
（4）订票：由售票点授权或是有一定信誉的售票代理商替代旅客进行预订车票，售票代理商通过电话或是亲自到售票点预订的方式进行预订车票。   
（5）退票：处理用户由于某种情况需要退回车票的情况，旅客要在车站指定的时间内进行退票，此外车站售票点还要扣除一定的手续费。        
（6）统计：售票统计分别可以按日期统计、按车次统计、按客流方向统计等统计方式，通过察看车票的流向可以得知旅客的大致流向，列车管理人员可以根据客流的流向随时调整列车运行车次，达到列车的合理调度，使列车最大限度的投入使用中，实现资源的合理利用。
（7）修改：包括车次修改、票价修改、站点修改。车次修改包括增加车次，减
少车次，车次的临时调度和由于自然灾害造成的临时路线更改。票价修改为节假日、春运等特殊时段或某些特殊地域需要适量增加或减少票价，具体数字有铁路管理定。站点修改可是某些车次增加或减少一些站点。    
（8）系统管理维护：管理员通过系统添加用户或者删除用户，并且授予权限，同时维护数据库，保证系统正确运行。 

2.2软件结构 

1.主要功能：完善火车票售票系统，方便铁路局的售票工作，提高铁路局的服务 质量和服务效率。   
2.性能要求：火车站提供的信息必须及时的反映在铁路局的工作平台上。售票系统的定单必须无差错的存储在火车站的主服务器上。对服务器上的数据必须进行及时正确的刷新。   
3.输入要求：数据完整，详实。  
4.输出要求：简捷，快速，实时。
5.安全与保密要求：售票员享有对火车站票务信息数据库、列车信息数据库的 管理与修改。旅客只享有对票务信息数据库的部分修（写入与读出）。     
该系统仅限火车站内部使用，因此使用C/S架构开发。同时，要实现客户端之间使用局域网技术互联，实现数据的共享，另外要求相互之间的操作互不影响。同一张火车票只能由一个客户端卖出，使用线程的同步来实现。


3．程序描述    
通过需求分析和概要设计，可以得出火车站售票系统的的类图，该系统中主要包括四个基本类：售票员，火车票，管理员，购票者。购票者向售票员提出请求，购票者有请求购票，请求查询，请求订票，请求退票和请求改签这几个功能。售票员通过与购票者交流后了解购票者的请求信息，进入系统进行操作。售票员和管理员均需要对火车票进行操作，同时，管理员需录入员工信息，维护数据库。

将如上系统类图进行进一步的抽象，可以得出系统的抽象类图，从而在讨论接口问题时，可以更加的清楚，明确。系统主要抽象出三个类、一个接口，将三个类封装到Unit包中，将Com接口封装在Com包中。其中Com接口是该系统主要功能的集合， Com可使用Unit，SQLclient包中的类。Form包包括图形化界面，通过Com包引用。通过Search类来实现查询功能，Sell类实现售票功能，包括售全价票与半价票，Refund实现退票功能，Alter实现修改功能，Count实现统计功能。


3.1登录模块 
3.1.1功能  
登录可分为系统管理员登录和售票员登录，在登录模块的描述中，将系统管理员和售票员都看作这个系统的用户，他们根据自己的登录名和密码登录系统，才可进行以后的操作。若用户名和密码输入错误，不匹配，系统将会提示输入错误。若用户名和密码不正确，用户可已重新输入，但只允许输入三次。    
3.1.2性能    
用户通过用户名和密码进入系统，可以确保系统的安全，由于系统管理员和售票员具有不同的权限，因此可以确保系统的权限分明。 
3.1.3输入项目
用户输入用户名、密码，通过数据库的封装以下表格中。    
3.1.4输出项目 
根据数据库中存在的表中信息来查询，判断用户名、密码是否正确，正确则显示登录成功信息，若用户名和密码不匹配则提示输入错误。  
3.1.5算法
   	该模块通过访问数据库查询用户登录信息，提取用户输入的用户名和密码，封装成SELECT语句，到数据库中查询相关信息，将信息返回到用户界面。若用户输入错误，弹出错误提示框。    
3.1.6程序逻辑

3.1.7接口   
该模块通过Com接口中的Search方法访问数据库，Com接口提供连接数据库的功能。在售票模块中会调用此模块。    
3.1.8存储分配 
对数据库采取日志记录技术和海量转储技术，并定期进行数据库备份。    
3.1.9限制条件  
由于登录系统是需要用户名和密码，因此需要用户正确输入用户名和密码，并且是已经注册过的用户。  
3.1.10测试要点   
确认测试则是要检查已实现的系统软件是否满足了需求规格说明中确定了的各种需求，以及系统软件配置是否完全、正确。系统测试，是将通过确认测试的软件，作为整个基于计算机系统的一个元素，与计算机硬件、外设、某些支持软件、数据和人员等其他系统元素结合在一起，在实际运行环境下，对计算机系统进行一系列的组装测试和确认测试。在登录模块中重点需要测试如下：  
（1）输入数据有效性判定；   
（2）有效数据输出测试，无效数据输出测试。   
（3）系统安全性和反应速度进行测试，系统的稳定性要求   
 
3.2查询模块  
3.2.1功能

查询可分为按车次查询与站点查询，用户通过输入待查询车次或者站点查询车票的相关信息，包括票价，时刻，剩余票数等信息。若用户输入的车次或者站点错误，系统会提示输入错误。
3.2.2性能    
能够对乘客要求的大部分查询类型都能够查询，每个查询功能键都一目了然，能快速精确的显示要查询的信息。    
3.2.3输入项目  
车次号、站名  
3.2.4输出项目


通过车辆表信息和时刻表信息，系统可以输出车次号、站点、发车时间、到站时间、剩余票数等信息。 
3.2.5算法 
  该模块通过访问数据库查询车票信息，提取用户输入的车次或者站名，封装成SELECT语句，到数据库中查询车票信息，将信息返回到用户界面。若用户输入错误，弹出错误提示框。    3.2.6程序逻辑


3.2.7接口    
该模块通过Com接口中的Search方法访问数据库，Com接口提供连接数据库的功能。在售票模块中会调用此模块。    
3.2.8存储分配   
对数据库采取日志记录技术和海量转储技术，并定期进行数据库备份。    
3.2.9限制条件    
由于从查询到查看查询内容全部靠电脑完成，所以需要用户熟悉电脑的基本操作。同时，系统中必须存在的人工处理过程，例如一些信息需要人工输入电脑。    
3.2.10测试要点    
确认测试则是要检查已实现的系统软件是否满足了需求规格说明中确定了的各种需求，以及系统软件配置是否完全、正确。系统测试，是将通过确认测试的软件，作为整个基于计算机系统的一个元素，与计算机硬件、外设、某些支持软件、数据和人员等其他系统元素结合在一起，在实际运行环境下，对计算机系统进行一系列的组装测试和确认测试。在查询模块中重点需要测试如下：    
（1）输入数据有效性判定；   
（2）有效数据输出测试，无效数据输出测试。
3.3售票模块  
3.3.1功能

根据旅客的需求如发车日期、发车时间、车票类型（学生票、军人票…）等，售票员查询相关的车票信息，选择用户所需要的车次，然后结算并打印车票给旅客。    
3.3.2性能
3.3.3输入项目 
车次、站点、日期 
3.3.4 输出项目

根据数据库中存放的车票表，显示车票信息、剩余票数等相关信息。 
3.3.5算法
售票员输入顾客预购车票的相关信息，到数据库中查询是否有票，若有则打印火车票给顾客，数据库中改车次车票自动减去卖出的票数；若无则提示售票员车票已售完。  
3.3.6程序逻辑

3.3.7接口    
售票模块提供一个调用查询模块的接口，在Com包中定义。    
3.3.8存储分配   
对数据库采取日志记录技术和海量转存技术，并定期进行数据库备份    
3.3.9限制条件    
由于售票过程存在人工处理过程，需要售票员进行人工输入，因此对售票员 有一定的专业要求，需要熟悉电脑的基本操作。
3.3.10测试要点    
确认测试则是要检查已实现的系统软件是否满足了需求规格说明中确定了的各种需求，以及系统软件配置是否完全、正确。系统测试，是将通过确认测试的软件，作为整个基于计算机系统的一个元素，与计算机硬件、外设、某些支持软件、数据和人员等其他系统元素结合在一起，在实际运行环境下，对计算机系统进行一系列的组装测试和确认测试。在售票模块中重点需要测试如下： 
（1）查询数据的有效性  
（2）正确打印出车票，票数正确

